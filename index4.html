<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css2?family=Syncopate:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/ScrollTrigger.min.js"></script>
    <script async="" src="https://unpkg.com/lenis@1.2.3/dist/lenis.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/lenis@1.2.3/dist/lenis.css">
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = 'https://unpkg.com/lenis@1.2.3/dist/lenis.css';
        document.head.appendChild(link);
        var script = document.createElement('script');
        script.src = 'https://unpkg.com/lenis@1.2.3/dist/lenis.min.js';
        script.onload = function() {
        let lenis = new Lenis({
            lerp: 0.06,
            wheelMultiplier: 0.3,
            gestureOrientation: "vertical",
            normalizeWheel: false,
            smoothTouch: false,
        });

        function raf(time) {
            lenis.raf(time);
            requestAnimationFrame(raf);
        }
        requestAnimationFrame(raf);
        };
        document.head.appendChild(script);
    });
    </script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            overflow-x: hidden;
            perspective: 1px;
        }
        .scroll_content{
            margin: 0;
            padding: 0;
            height: 150vh;
            position: sticky;
            top: 0;
        }

        .text-block {
            will-change: transform;
            border: none;
            outline: none;
            box-shadow: none;
            font-family: 'Syncopate', sans-serif;
            font-weight: 700;
            font-size: 480px;
            color: white;
            white-space: nowrap;
            position: absolute;
            top: 50%;
            left: 130%;
            transform: translate(-50%, -50%) translateY(0) translateZ(0) scale(1);
            line-height: 0.83;
            padding: 0;
            margin: 0;
            vertical-align: top;
            display: flex;
            align-items: center;
            overflow: hidden;

        }
        .toilet{
            height: 500vh;
        }
        
        .hero {
            width: 100%;
            height: 100vh;
            position: sticky;
            top: 0;
            align-content: center;
            place-items: center;
            overflow: clip;
        }

        .toilet{
            width: 100%;
            height: auto;
        }

        .brown_shit{
            width: 100%;
            height: 300vh;
            position: sticky;
            top: 0;
        }

        .szczyny{
            background-color: white;
            height: 100vh;
            width: 100%;
            position: sticky;
            top: 0;
            will-change: scale;
            justify-items: center;
            
            place-content: center;
        }

        .sraka{
            background-color: brown;
            height: 100vh;
            display: flex;
            place-content: center;
        }

        .video_container{
            width: 900px;
            height: 500px;
            overflow: clip;
            display: flex;
            flex-direction: column;
            justify-items: center;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div class="toilet">
        <div class="scroll_content">
            <div class="hero">
            </div>
        </div>
        <div class="brown_shit" id="brown_shit">
            <div id="szczyny" class="szczyny">
                <div class="video_container">
                    <video id="vid" autoplay loop muted style="filter: url(#tv); width: 1280px; height: 960px;">
                        <source src="https://cdn.prod.website-files.com/6470c46e6d62006dbae74804%2F678f765ffe88b4e435207922_6470C46e6d62006dbae74804%2066Fe53fb2dbda47df8bf0373%20Pucha%20Moya%201920%20X%20700-Transcode-transcode.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>
    </div>

    <div class="sraka">
        jakies inne gowno
    </div>

</body>
</html>

<script>
  const steps = 16;

    const backOut = gsap.parseEase("back.out(10)");
    const eased_values = Array.from({ length: steps + 1 }, (_, i) =>
    (-backOut(i / steps) * 50) + 200
    );


  for (let i = 0; i < steps; i++) {
      const div = document.createElement('span');
      div.className = 'text-block';
      div.id = `text-block_${i}`;
      div.textContent = 'REEQUEST';
      const start = (i * 100) / steps;
      const end = ((i + 1) * 100) / steps;
      div.style.webkitMaskImage = `linear-gradient(to bottom, transparent 0%, transparent ${start}%, white ${start}%, white ${end}%, transparent ${end}%, transparent 100%)`;
      div.style.maskImage = div.style.webkitMaskImage;
      document.querySelector('.hero').appendChild(div);
  }

  function move_shit(element, offset){
      gsap.to(`#${element.id}`, {
          scrollTrigger: {
              trigger: "body",
              start: () => `top+=${window.innerHeight * 0.005 + offset}px`,
              end: () => `top+=${window.innerHeight * 1.2 - offset}px`,
              scrub: 0.5
          },
          x: "-150%",
          y: 0,
          z: 0,
          force3D: true,
          onUpdate: () => {
            gsap.to(`#${element.id}`, {
              y: 0,
            });
          }
      });
  }

  window.addEventListener('load', () => {
    gsap.registerPlugin(ScrollTrigger);
    const TextElemnts = document.getElementsByClassName('text-block');
    Array.from(TextElemnts).reverse().forEach((element, index) => {
        gsap.to(`#${element.id}`, {
            y: 0,
            duration: 0
        });
        move_shit(element, eased_values[index]);
    });

    gsap.fromTo('#szczyny', 
        { scale: 0.5 }, 
        {
            scrollTrigger: {
                trigger: "#szczyny",
                start: "top 55%",
                end: "top 45%",
                markers: true,
                scrub: true
            },
            scale: 1,
            ease: "power1.out",
            force3D: true
        }
    );



  });

</script>
